# OpenAPI spec generated by vervet, DO NOT EDIT
components:
  headers:
    DeprecationHeader:
      description: |
        A header containing the deprecation date of the underlying endpoint. For more information, please refer to the deprecation header RFC:
        https://tools.ietf.org/id/draft-dalal-deprecation-header-01.html
      example: "2021-07-01T00:00:00Z"
      schema:
        format: date-time
        type: string
    RequestIdResponseHeader:
      description: |
        A header containing a unique id used for tracking this request. If you are reporting an issue to Snyk it's very helpful to provide this ID.
      example: 4b58e274-ec62-4fab-917b-1d2c48d6bdef
      schema:
        format: uuid
        type: string
    SunsetHeader:
      description: |
        A header containing the date of when the underlying endpoint will be removed. This header is only present if the endpoint has been deprecated. Please refer to the RFC for more information:
        https://datatracker.ietf.org/doc/html/rfc8594
      example: "2021-08-02T00:00:00Z"
      schema:
        format: date-time
        type: string
    VersionRequestedResponseHeader:
      description: A header containing the version of the endpoint requested by the
        caller.
      example: "2021-06-04"
      schema:
        $ref: '#/components/schemas/QueryVersion'
    VersionServedResponseHeader:
      description: A header containing the version of the endpoint that was served
        by the API.
      example: "2021-06-04"
      schema:
        $ref: '#/components/schemas/ActualVersion'
    VersionStageResponseHeader:
      description: |
        A header containing the version stage of the endpoint. This stage describes the guarantees snyk provides surrounding stability of the endpoint.
      schema:
        enum:
        - wip
        - experimental
        - beta
        - ga
        - deprecated
        - sunset
        example: ga
        type: string
  parameters:
    Ecosystem:
      description: Ecosystem name (e.g., npm, maven, pypi)
      in: path
      name: ecosystem
      required: true
      schema:
        example: npm
        type: string
    OrgId:
      description: Org ID
      in: path
      name: org_id
      required: true
      schema:
        format: uuid
        type: string
    PackageName:
      description: Package name (URL encoded if needed)
      in: path
      name: package_name
      required: true
      schema:
        example: express
        type: string
    PackageVersion:
      description: Package version (URL encoded if needed)
      in: path
      name: package_version
      required: true
      schema:
        example: 4.19.2
        type: string
    Version:
      description: The requested version of the endpoint to process the request
      example: "2021-06-04"
      in: query
      name: version
      required: true
      schema:
        $ref: '#/components/schemas/QueryVersion'
  responses:
    "400":
      content:
        application/vnd.api+json:
          schema:
            $ref: '#/components/schemas/ErrorDocument'
      description: 'Bad Request: A parameter provided as a part of the request was
        invalid.'
      headers:
        deprecation:
          $ref: '#/components/headers/DeprecationHeader'
        snyk-request-id:
          $ref: '#/components/headers/RequestIdResponseHeader'
        snyk-version-lifecycle-stage:
          $ref: '#/components/headers/VersionStageResponseHeader'
        snyk-version-requested:
          $ref: '#/components/headers/VersionRequestedResponseHeader'
        snyk-version-served:
          $ref: '#/components/headers/VersionServedResponseHeader'
        sunset:
          $ref: '#/components/headers/SunsetHeader'
    "401":
      content:
        application/vnd.api+json:
          schema:
            $ref: '#/components/schemas/ErrorDocument'
      description: 'Unauthorized: the request requires an authentication token.'
      headers:
        deprecation:
          $ref: '#/components/headers/DeprecationHeader'
        snyk-request-id:
          $ref: '#/components/headers/RequestIdResponseHeader'
        snyk-version-lifecycle-stage:
          $ref: '#/components/headers/VersionStageResponseHeader'
        snyk-version-requested:
          $ref: '#/components/headers/VersionRequestedResponseHeader'
        snyk-version-served:
          $ref: '#/components/headers/VersionServedResponseHeader'
        sunset:
          $ref: '#/components/headers/SunsetHeader'
    "403":
      content:
        application/vnd.api+json:
          schema:
            $ref: '#/components/schemas/ErrorDocument'
      description: 'Forbidden: the request requires an authentication token with more
        or different permissions.'
      headers:
        deprecation:
          $ref: '#/components/headers/DeprecationHeader'
        snyk-request-id:
          $ref: '#/components/headers/RequestIdResponseHeader'
        snyk-version-lifecycle-stage:
          $ref: '#/components/headers/VersionStageResponseHeader'
        snyk-version-requested:
          $ref: '#/components/headers/VersionRequestedResponseHeader'
        snyk-version-served:
          $ref: '#/components/headers/VersionServedResponseHeader'
        sunset:
          $ref: '#/components/headers/SunsetHeader'
    "404":
      content:
        application/vnd.api+json:
          schema:
            $ref: '#/components/schemas/ErrorDocument'
      description: 'Not Found: The resource being operated on could not be found.'
      headers:
        deprecation:
          $ref: '#/components/headers/DeprecationHeader'
        snyk-request-id:
          $ref: '#/components/headers/RequestIdResponseHeader'
        snyk-version-lifecycle-stage:
          $ref: '#/components/headers/VersionStageResponseHeader'
        snyk-version-requested:
          $ref: '#/components/headers/VersionRequestedResponseHeader'
        snyk-version-served:
          $ref: '#/components/headers/VersionServedResponseHeader'
        sunset:
          $ref: '#/components/headers/SunsetHeader'
    "409":
      content:
        application/vnd.api+json:
          schema:
            $ref: '#/components/schemas/ErrorDocument'
      description: 'Conflict: The requested operation conflicts with the current state
        of the resource in some way.'
      headers:
        deprecation:
          $ref: '#/components/headers/DeprecationHeader'
        snyk-request-id:
          $ref: '#/components/headers/RequestIdResponseHeader'
        snyk-version-lifecycle-stage:
          $ref: '#/components/headers/VersionStageResponseHeader'
        snyk-version-requested:
          $ref: '#/components/headers/VersionRequestedResponseHeader'
        snyk-version-served:
          $ref: '#/components/headers/VersionServedResponseHeader'
        sunset:
          $ref: '#/components/headers/SunsetHeader'
    "500":
      content:
        application/vnd.api+json:
          schema:
            $ref: '#/components/schemas/ErrorDocument'
      description: 'Internal Server Error: An error was encountered while attempting
        to process the request.'
      headers:
        deprecation:
          $ref: '#/components/headers/DeprecationHeader'
        snyk-request-id:
          $ref: '#/components/headers/RequestIdResponseHeader'
        snyk-version-lifecycle-stage:
          $ref: '#/components/headers/VersionStageResponseHeader'
        snyk-version-requested:
          $ref: '#/components/headers/VersionRequestedResponseHeader'
        snyk-version-served:
          $ref: '#/components/headers/VersionServedResponseHeader'
        sunset:
          $ref: '#/components/headers/SunsetHeader'
  schemas:
    ActualVersion:
      description: Resolved API version
      pattern: ^((([0-9]{4})-([0-1][0-9]))-((3[01])|(0[1-9])|([12][0-9]))(~(wip|work-in-progress|experimental|beta))?)$
      type: string
    BasePackageAttributes:
      description: Common attributes shared between package and package version resources
      properties:
        description:
          example: Fast, unopinionated, minimalist web framework
          type: string
        ecosystem:
          example: npm
          type: string
        keywords:
          example:
          - node
          - javascript
          - express
          - server
          items:
            type: string
          type: array
        language:
          example: JavaScript
          type: string
        owner_details:
          $ref: '#/components/schemas/OwnerDetails'
        package_health:
          $ref: '#/components/schemas/PackageHealth'
        package_id:
          example: pkg:npm/express
          type: string
        package_name:
          example: express
          type: string
      required:
      - package_id
      - ecosystem
      - package_name
      - language
      type: object
    CommunityDetails:
      properties:
        description:
          type: string
        has_code_of_conduct_file:
          type: boolean
        has_contributing_file:
          type: boolean
        has_funding_file:
          type: boolean
        has_readme_file:
          type: boolean
        rating:
          type: string
        stargazers_count:
          type: integer
      type: object
    DirectVulnerabilitiesCounts:
      properties:
        critical:
          type: integer
        high:
          type: integer
        low:
          type: integer
        medium:
          type: integer
      type: object
    Error:
      additionalProperties: false
      example:
        detail: Not Found
        status: "404"
      properties:
        code:
          description: An application-specific error code, expressed as a string value.
          example: entity-not-found
          type: string
        detail:
          description: A human-readable explanation specific to this occurrence of
            the problem.
          example: 'The request was missing these required fields: ...'
          type: string
        id:
          description: A unique identifier for this particular occurrence of the problem.
          example: f16c31b5-6129-4571-add8-d589da9be524
          format: uuid
          type: string
        links:
          $ref: '#/components/schemas/ErrorLink'
        meta:
          additionalProperties: true
          example:
            key: value
          type: object
        source:
          additionalProperties: false
          example:
            pointer: /data/attributes
          properties:
            parameter:
              description: A string indicating which URI query parameter caused the
                error.
              example: param1
              type: string
            pointer:
              description: A JSON Pointer [RFC6901] to the associated entity in the
                request document.
              example: /data/attributes
              type: string
          type: object
        status:
          description: The HTTP status code applicable to this problem, expressed
            as a string value.
          example: "400"
          pattern: ^[45]\d\d$
          type: string
        title:
          description: A short, human-readable summary of the problem that SHOULD
            NOT change from occurrence to occurrence of the problem, except for purposes
            of localization.
          example: Bad request
          type: string
      required:
      - status
      - detail
      type: object
    ErrorDocument:
      additionalProperties: false
      example:
        errors:
        - detail: Permission denied for this resource
          status: "403"
        jsonapi:
          version: "1.0"
      properties:
        errors:
          example:
          - detail: Permission denied for this resource
            status: "403"
          items:
            $ref: '#/components/schemas/Error'
          minItems: 1
          type: array
        jsonapi:
          $ref: '#/components/schemas/JsonApi'
      required:
      - jsonapi
      - errors
      type: object
    ErrorLink:
      additionalProperties: false
      description: A link that leads to further details about this particular occurrance
        of the problem.
      example:
        about: https://example.com/about_this_error
      properties:
        about:
          $ref: '#/components/schemas/LinkProperty'
      type: object
    JsonApi:
      additionalProperties: false
      example:
        version: "1.0"
      properties:
        version:
          description: Version of the JSON API specification this server supports.
          example: "1.0"
          pattern: ^(0|[1-9]\d*)\.(0|[1-9]\d*)$
          type: string
      required:
      - version
      type: object
    LinkProperty:
      example: https://example.com/api/resource
      oneOf:
      - description: A string containing the link’s URL.
        example: https://example.com/api/resource
        type: string
      - additionalProperties: false
        example:
          href: https://example.com/api/resource
        properties:
          href:
            description: A string containing the link’s URL.
            example: https://example.com/api/resource
            type: string
          meta:
            $ref: '#/components/schemas/Meta'
        required:
        - href
        type: object
    MaintenanceDetails:
      properties:
        description:
          type: string
        first_release_published_at:
          format: date-time
          type: string
        forks_count:
          type: integer
        is_archived:
          type: boolean
        is_forked:
          type: boolean
        latest_release_number:
          type: string
        latest_release_published_at:
          format: date-time
          type: string
        lifecycle:
          type: string
        rating:
          type: string
        total_versions_count:
          type: integer
      type: object
    Meta:
      additionalProperties: true
      description: Free-form object that may contain non-standard information.
      example:
        key1: value1
        key2:
          sub_key: sub_value
        key3:
        - array_value1
        - array_value2
      type: object
    OwnerDetails:
      properties:
        followers_count:
          type: integer
        location:
          type: string
        name:
          type: string
        repositories_count:
          type: integer
        total_stars:
          type: integer
      type: object
    PackageAttributes:
      allOf:
      - $ref: '#/components/schemas/BasePackageAttributes'
      - properties:
          latest_version:
            example: 4.19.2
            type: string
          package_details:
            $ref: '#/components/schemas/PackageDetails'
        type: object
      description: Attributes for a package resource
      example:
        ecosystem: npm
        language: JavaScript
        latest_version: 4.19.2
        owner_details:
          followers_count: 123
          location: somewhere
          name: expressjs
          repositories_count: 45
          total_stars: 65000
        package_details:
          homepage_url: https://expressjs.com
          registry_url: https://www.npmjs.com/package/express
          repository_url: https://github.com/expressjs/express
        package_health:
          community:
            description: '...'
            has_code_of_conduct_file: true
            has_contributing_file: true
            has_funding_file: false
            has_readme_file: true
            rating: Active
            stargazers_count: 75000
          description: The package has mixed or concerning signals that require closer
            review. Applies to medium, high, and critical vulnerabilities. Low-severity
            vulnerabilities are excluded.
          maintenance:
            description: '...'
            first_release_published_at: "2010-01-03T00:00:00Z"
            forks_count: 66
            is_archived: false
            is_forked: false
            latest_release_number: 4.19.2
            latest_release_published_at: "2024-10-08T00:00:00Z"
            lifecycle: active
            rating: Healthy
            total_versions_count: 760
          overall_rating: Review recommended
          popularity:
            dependent_packages_count: 280
            dependent_repos_count: 65000
            description: '...'
            downloads: 12000
            rating: Influential
          security:
            description: '...'
            direct_vulnerabilities: true
            direct_vulnerabilities_total: 3
            rating: Security review needed
        package_id: pkg:npm/express
        package_name: express
    PackageDetails:
      description: Base package details with URLs
      properties:
        homepage_url:
          example: https://expressjs.com
          type: string
        registry_url:
          example: https://www.npmjs.com/package/express
          type: string
        repository_url:
          example: https://github.com/expressjs/express
          type: string
      type: object
    PackageHealth:
      properties:
        community:
          $ref: '#/components/schemas/CommunityDetails'
        description:
          type: string
        maintenance:
          $ref: '#/components/schemas/MaintenanceDetails'
        overall_rating:
          type: string
        popularity:
          $ref: '#/components/schemas/PopularityDetails'
        security:
          $ref: '#/components/schemas/SecurityDetails'
      type: object
    PackageVersionAttributes:
      allOf:
      - $ref: '#/components/schemas/BasePackageAttributes'
      - properties:
          latest_version_indicator:
            example: true
            type: boolean
          package_details:
            $ref: '#/components/schemas/PackageVersionDetails'
          package_version:
            example: 4.19.2
            type: string
          package_version_id:
            example: pkg:npm/express@4.19.2
            type: string
          published_at:
            example: "2024-10-08T00:00:00Z"
            format: date-time
            type: string
        required:
        - package_version_id
        - package_version
        type: object
      description: Attributes for a package version resource
      example:
        ecosystem: npm
        language: JavaScript
        latest_version_indicator: true
        owner_details:
          followers_count: 123
          location: somewhere
          name: expressjs
          repositories_count: 45
          total_stars: 65000
        package_details:
          download_url: https://registry.npmjs.org/express/-/express-4.19.2.tgz
          homepage_url: https://expressjs.com
          registry_url: https://www.npmjs.com/package/express
          registry_version_url: https://www.npmjs.com/package/express/v/4.19.2
          repository_url: https://github.com/expressjs/express
        package_health:
          community:
            description: '...'
            has_code_of_conduct_file: true
            has_contributing_file: true
            has_funding_file: false
            has_readme_file: true
            rating: Active
            stargazers_count: 75000
          description: The package has mixed or concerning signals that require closer
            review. Applies to medium, high, and critical vulnerabilities. Low-severity
            vulnerabilities are excluded.
          maintenance:
            description: '...'
            first_release_published_at: "2010-01-03T00:00:00Z"
            forks_count: 66
            is_archived: false
            is_forked: false
            latest_release_number: 4.19.2
            latest_release_published_at: "2024-10-08T00:00:00Z"
            lifecycle: active
            rating: Healthy
            total_versions_count: 760
          overall_rating: Review recommended
          popularity:
            dependent_packages_count: 280
            dependent_repos_count: 65000
            description: '...'
            downloads: 12000
            rating: Influential
          security:
            description: '...'
            direct_vulnerabilities: true
            direct_vulnerabilities_total: 3
            rating: Security review needed
        package_id: pkg:npm/express
        package_name: express
        package_version: 4.19.2
        package_version_id: pkg:npm/express@4.19.2
        published_at: "2024-10-08T00:00:00Z"
    PackageVersionDetails:
      allOf:
      - $ref: '#/components/schemas/PackageDetails'
      - properties:
          download_url:
            example: https://registry.npmjs.org/express/-/express-4.19.2.tgz
            type: string
          registry_version_url:
            example: https://www.npmjs.com/package/express/v/4.19.2
            type: string
        type: object
    PopularityDetails:
      properties:
        dependent_packages_count:
          type: integer
        dependent_repos_count:
          type: integer
        description:
          type: string
        downloads:
          type: integer
        rating:
          type: string
      type: object
    QueryVersion:
      description: Requested API version
      pattern: ^(wip|work-in-progress|experimental|beta|((([0-9]{4})-([0-1][0-9]))-((3[01])|(0[1-9])|([12][0-9]))(~(wip|work-in-progress|experimental|beta))?))$
      type: string
    SecurityDetails:
      properties:
        description:
          type: string
        direct_vulnerabilities:
          type: boolean
        direct_vulnerabilities_counts:
          $ref: '#/components/schemas/DirectVulnerabilitiesCounts'
        direct_vulnerabilities_total:
          type: integer
        rating:
          type: string
      type: object
info:
  title: package-api-service
  version: 3.0.0
openapi: 3.0.3
paths:
  /openapi:
    get:
      description: List available versions of OpenAPI specification
      operationId: listAPIVersions
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  type: string
                type: array
          description: List of available versions is returned
          headers:
            snyk-request-id:
              $ref: '#/components/headers/RequestIdResponseHeader'
        "400":
          $ref: '#/components/responses/400'
        "401":
          $ref: '#/components/responses/401'
        "404":
          $ref: '#/components/responses/404'
        "500":
          $ref: '#/components/responses/500'
      tags:
      - OpenAPI
  /openapi/{version}:
    get:
      description: Get OpenAPI specification effective at version.
      operationId: getAPIVersion
      parameters:
      - description: The requested version of the API
        in: path
        name: version
        required: true
        schema:
          type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                type: object
          description: OpenAPI specification matching requested version is returned
          headers:
            snyk-request-id:
              $ref: '#/components/headers/RequestIdResponseHeader'
            snyk-version-requested:
              $ref: '#/components/headers/VersionRequestedResponseHeader'
            snyk-version-served:
              $ref: '#/components/headers/VersionServedResponseHeader'
        "400":
          $ref: '#/components/responses/400'
        "401":
          $ref: '#/components/responses/401'
        "404":
          $ref: '#/components/responses/404'
        "500":
          $ref: '#/components/responses/500'
      tags:
      - OpenAPI
  /orgs/{org_id}/ecosystems/{ecosystem}/packages/{package_name}:
    get:
      description: Get package metadata for a specific package from an ecosystem
      operationId: getPackage
      parameters:
      - $ref: '#/components/parameters/Version'
      - $ref: '#/components/parameters/OrgId'
      - $ref: '#/components/parameters/Ecosystem'
      - $ref: '#/components/parameters/PackageName'
      responses:
        "200":
          content:
            application/vnd.api+json:
              schema:
                additionalProperties: false
                properties:
                  data:
                    additionalProperties: false
                    description: package resource object
                    properties:
                      attributes:
                        $ref: '#/components/schemas/PackageAttributes'
                      id:
                        example: pkg:npm/express
                        format: uri
                        type: string
                      type:
                        example: package
                        type: string
                    required:
                    - id
                    - type
                    type: object
                  jsonapi:
                    $ref: '#/components/schemas/JsonApi'
                  links:
                    additionalProperties: false
                    properties:
                      self:
                        example: https://api.snyk.io/rest/orgs/12345/ecosystems/npm/packages/express?version=2024-10-15
                        format: uri
                        type: string
                    type: object
                type: object
          description: Returns package metadata
          headers:
            deprecation:
              $ref: '#/components/headers/DeprecationHeader'
            snyk-request-id:
              $ref: '#/components/headers/RequestIdResponseHeader'
            snyk-version-lifecycle-stage:
              $ref: '#/components/headers/VersionStageResponseHeader'
            snyk-version-requested:
              $ref: '#/components/headers/VersionRequestedResponseHeader'
            snyk-version-served:
              $ref: '#/components/headers/VersionServedResponseHeader'
            sunset:
              $ref: '#/components/headers/SunsetHeader'
        "400":
          $ref: '#/components/responses/400'
        "401":
          $ref: '#/components/responses/401'
        "403":
          $ref: '#/components/responses/403'
        "404":
          $ref: '#/components/responses/404'
        "409":
          $ref: '#/components/responses/409'
        "500":
          $ref: '#/components/responses/500'
      summary: Get a package
      tags:
      - Package
      x-cerberus:
        authorization:
          resource:
            entitlements:
            - api
            pathId: org_id
            permissions:
            - read
            type: org
        enableAccessAudit: true
      x-snyk-api-lifecycle: released
      x-snyk-api-owners:
      - '@snyk/intelligence-engineering'
      - '@snyk/codesec_intelligence-engineering'
      x-snyk-api-releases:
      - 2024-10-15~beta
      x-snyk-api-resource: packages
      x-snyk-api-stability: beta
      x-snyk-api-version: 2024-10-15~beta
      x-stability-level: beta
  /orgs/{org_id}/ecosystems/{ecosystem}/packages/{package_name}/versions/{package_version}:
    get:
      description: Get package version metadata for a specific version of a package
        from an ecosystem
      operationId: getPackageVersion
      parameters:
      - $ref: '#/components/parameters/Version'
      - $ref: '#/components/parameters/OrgId'
      - $ref: '#/components/parameters/Ecosystem'
      - $ref: '#/components/parameters/PackageName'
      - $ref: '#/components/parameters/PackageVersion'
      responses:
        "200":
          content:
            application/vnd.api+json:
              schema:
                additionalProperties: false
                properties:
                  data:
                    additionalProperties: false
                    description: package version resource object
                    properties:
                      attributes:
                        $ref: '#/components/schemas/PackageVersionAttributes'
                      id:
                        example: pkg:npm/express@4.19.2
                        format: uri
                        type: string
                      package_version:
                        example: 4.19.2
                        type: string
                      type:
                        example: package_version
                        type: string
                    required:
                    - id
                    - type
                    - package_version
                    type: object
                  jsonapi:
                    $ref: '#/components/schemas/JsonApi'
                  links:
                    additionalProperties: false
                    properties:
                      self:
                        example: https://api.snyk.io/rest/orgs/12345/ecosystems/npm/packages/express/versions/4.19.2?version=2024-10-15
                        format: uri
                        type: string
                    type: object
                type: object
          description: Returns package version metadata
          headers:
            deprecation:
              $ref: '#/components/headers/DeprecationHeader'
            snyk-request-id:
              $ref: '#/components/headers/RequestIdResponseHeader'
            snyk-version-lifecycle-stage:
              $ref: '#/components/headers/VersionStageResponseHeader'
            snyk-version-requested:
              $ref: '#/components/headers/VersionRequestedResponseHeader'
            snyk-version-served:
              $ref: '#/components/headers/VersionServedResponseHeader'
            sunset:
              $ref: '#/components/headers/SunsetHeader'
        "400":
          $ref: '#/components/responses/400'
        "401":
          $ref: '#/components/responses/401'
        "403":
          $ref: '#/components/responses/403'
        "404":
          $ref: '#/components/responses/404'
        "409":
          $ref: '#/components/responses/409'
        "500":
          $ref: '#/components/responses/500'
      summary: Get a package version
      tags:
      - Package Version
      x-cerberus:
        authorization:
          resource:
            entitlements:
            - api
            pathId: org_id
            permissions:
            - read
            type: org
        enableAccessAudit: true
      x-snyk-api-lifecycle: released
      x-snyk-api-owners:
      - '@snyk/intelligence-engineering'
      - '@snyk/codesec_intelligence-engineering'
      x-snyk-api-releases:
      - 2024-10-15~beta
      x-snyk-api-resource: versions
      x-snyk-api-stability: beta
      x-snyk-api-version: 2024-10-15~beta
      x-stability-level: beta
servers:
- description: package-api-service
  url: /rest
tags:
- description: The OpenAPI specification for package-api-service.
  name: OpenAPI
x-cerberus:
  authentication:
    strategies:
    - InternalJWT: {}
x-snyk-api-version: "2024-10-15"
